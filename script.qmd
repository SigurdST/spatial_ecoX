---
title: "Project in Spatial Econometrics"
format: html
editor: visual
authors: "Anaïs BOUGHANEM, Théo DRUILHE and Sigurd SAUE"
---

We download the necessary packages.

```{r, message=FALSE, warning=FALSE}
library(dplyr)
library(sf)
library(WDI)
```

# 1 Data

## 1.1 Migration flow data

We first load and analyze the data.

```{r}
# Load the migration data
load("mig_data.RData")

# Inspect the structure of the data
str(mig_data)
```

```{r}
# Filter for the period 2020–2024 and select the Pseudo-Bayesian flow estimates

mig_rate_2020_2024 <- mig_data %>%
  filter(period == "2020-2024") %>%
  select(origin, dest, mig_rate)

# Check the first few rows of the result
head(mig_rate_2020_2024)
```

### Migration Rate Method

Dennett (2016) proposed a method to estimate bilateral migration flows using a **single stock table** and an estimate of **total global migration**. This approach allows us to generate directional flows even when direct flow data is unavailable.

#### Step-by-Step Method

Let:

- $s_{gh}^t$: Number of migrants **from origin** $g$ living in **destination** $h$ at time $t$
- $M^t$: Estimated **total global migration** for the period
- $r_{gh}^t$: Estimated **flow rate** from $g$ to $h$ at time $t$
- $F_{g \rightarrow h}^t$: Estimated **flow** from $g$ to $h$

Then:

1. **Compute global migration rate**:
   $$
   r_{gh}^t = \frac{s_{gh}^t}{\sum_{g \neq h} s_{gh}^t}
   $$
   The denominator is the sum of all off-diagonal stock values — i.e., total foreign-born population globally.

2. **Estimate total migration flows (M)**:
   Since $M^t$ is not directly known, it's approximated by:
   $$
   M^t = \sum_h \left| \sum_g s_{gh}^{t+1} - \sum_g s_{gh}^{t} \right|
   $$
   This is the **sum of absolute net migration changes** per destination (column totals).

3. **Estimate bilateral flow**:
   $$
   F_{g \rightarrow h}^t = M^t \times r_{gh}^t
   $$

#### Interpretation

- The stock table provides the **relative distribution** of migrants.
- The sum of absolute net changes provides a **scaling factor** for total migration volume.
- The resulting flows maintain **global consistency** while reflecting the stock structure.

### Description of the Migration Rate Flow Map (2020–2024)

The map displays the largest bilateral migration flows for the period 2020–2024, estimated using the Migration Rate method. In this visualization, arrows represent the direction and relative magnitude of flows between countries, while vertical bars beside each country illustrate the total volume of outgoing (left bar) and incoming (right bar) flows.

This method emphasizes migration intensity, meaning flows are normalized by the size of the origin population. As such, it reveals not only where large numbers of people are moving, but also which countries are experiencing high migration rates relative to their population size.

Several prominent migration corridors are visible:

- From Latin America to North America, especially strong flows from Mexico and Central America to the United States.
- From South Asia and Southeast Asia to the Gulf countries or to the United States and Canada.
- From Eastern Europe to Western Europe, especially toward Germany and the UK.

Major countries of origin with significant outward migration include India, Mexico, Syria and the Philippines. On the receiving side, major destinations include the United States, Germany, the United Kingdom, France, Australia, and the Gulf states.

The map highlights both the volume and directionality of global migration, showing that migration flows are not evenly distributed but rather concentrated in a few dominant corridors.

### Comparison of the Migration Rate Method with Other Estimation Methods

To evaluate the reliability and interpretability of the Migration Rate method, we compared it with five alternative estimation methods: Pseudo-Bayesian, Drop Negative, Reverse Negative, Minimization Open, and Minimization Close. The visualizations of each method reveal key similarities and differences in how major global flows are represented.

#### Similarities

Across all six maps, the same global migration corridors appear consistently, regardless of the estimation technique.

These consistent patterns suggest that the main global migration trends are robust across different estimation methods.

#### Notable Differences Between Methods

**Pseudo-Bayesian**

- Flows seem globally bigger than on the other maps.

**Drop Negative and Reverse Negative**

- These methods result in sparser maps with fewer visible corridors.
- Strong flows like Mexico to the US still appear, but smaller flows are often eliminated.

**Minimization Open and Close**

- Very similar to the Migration Rate method.

**Migration Rate**

- The Russia to Ukraine arrow is reversed compared to the other methods, indicating a different interpretation of the flow direction.

## 1.2 Contours data

We load the contours data and inspect it.

```{r}
# Import the world contours GeoJSON file
world <- st_read("CCMN_GeoDATA.geojson")

# Transform the Coordinate Reference System to ESRI:54030 (World Robinson projection)
world_proj <- st_transform(world, crs = 'ESRI:54030')
```
## 1.3 Explanatory variables at country level

```{r}
load("covariates.RData")
```

## Additional Explanatory Variable: Unemployment Rate

To complement the existing set of explanatory variables, we propose adding the **unemployment rate** as a potential determinant of international migration. A high unemployment rate in a country can push individuals to emigrate in search of better opportunities, while low unemployment in destination countries may attract migrants seeking employment.

This variable is used in several studies, including Hatton & Williamson (2002) and the OECD International Migration Outlook reports, as a key economic factor in explaining migration trends.

The data was retrieved from the **World Bank Open Data** platform, using indicator code `SL.UEM.TOTL.ZS`, and merged into the `my_covariates` dataset for the years corresponding to each migration period (e.g., 1992 for 1990–1995).

```{r}
# Download unemployment rate from World Bank (indicator code: SL.UEM.TOTL.ZS)
# We'll select data for years matching the reference points (1992, 1997, 2007, 2012, 2017, 2022)
unemp_data <- WDI(indicator = "SL.UEM.TOTL.ZS", start = 1992, end = 2022, extra = TRUE) %>%
  filter(year %in% c(1992, 1997, 2002, 2007, 2012, 2017, 2022)) %>%
  select(iso3c, year, unemployment_rate = SL.UEM.TOTL.ZS)
```

```{r}
# Merge unemployment data into the covariates
unemp_data <- unemp_data %>%
  mutate(year = as.character(year))
my_covariates <- my_covariates %>%
  mutate(period = recode(period,
                         "1990-1995" = "1992",
                         "1995-2000" = "1997",
                         "2000-2005" = "2002",
                         "2005-2010" = "2007",
                         "2010-2015" = "2012",
                         "2015-2020" = "2017",
                         "2020-2024" = "2022"))
my_covariates <- my_covariates %>%
  left_join(unemp_data, by = c("ISO3"="iso3c", "period"="year"))
my_covariates
```
